<!DOCTYPE html>
<html lang="sr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>To-Do lista — Miloš</title>
  <style>
    :root { --ink:#1f2937; --muted:#6b7280; --bg:#f6f7fb; --card:#ffffff; --accent:#2563eb; }
    * { box-sizing: border-box; }
    body { margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; background:var(--bg); color:var(--ink); }
    .wrap { max-width:720px; margin: 32px auto; padding: 0 16px; }
    .card { background:var(--card); border-radius:14px; box-shadow:0 6px 18px rgba(0,0,0,.08); padding:20px; }
    h1 { margin:0 0 12px; font-size:clamp(22px,3.5vw,32px); }
    .row { display:flex; gap:10px; }
    input[type="text"] { flex:1; padding:12px 14px; border:1px solid #e5e7eb; border-radius:10px; font-size:16px; }
    button { padding:12px 14px; border-radius:10px; border:1px solid var(--accent); background:var(--accent); color:#fff; font-weight:700; cursor:pointer; }
    button:disabled { opacity:.6; cursor:not-allowed; }
    ul { list-style:none; padding:0; margin:16px 0 0; }
    li { display:flex; align-items:center; justify-content:space-between; gap:10px; padding:10px 12px; border:1px solid #e5e7eb; border-radius:10px; background:#fff; margin-bottom:10px; }
    .task { display:flex; align-items:center; gap:10px; flex:1; }
    .task input[type="checkbox"] { width:18px; height:18px; }
    .task label { flex:1; }
    .done label { text-decoration: line-through; color: var(--muted); }
    .small { color:var(--muted); font-size:13px; margin-top:8px; }
    .ghost { background:transparent; color:var(--ink); border-color:#e5e7eb; }
  </style>
</head>
<body>
  <div class="wrap">
    <section class="card">
      <h1>To-Do lista</h1>
      <div class="row">
        <input id="newTask" type="text" placeholder="Novi zadatak…" autocomplete="off" />
        <button id="addBtn" aria-label="Dodaj zadatak">Dodaj</button>
      </div>
      <p class="small">Saveti: Enter dodaje zadatak • Klik na kvadratić = završeno • Sve se čuva lokalno (localStorage)</p>
      <ul id="list"></ul>
      <div class="row" style="margin-top:8px;">
        <button id="clearDone" class="ghost" aria-label="Obriši završene">Obriši završene</button>
        <button id="clearAll" class="ghost" aria-label="Obriši sve">Obriši sve</button>
      </div>
    </section>
  </div>

  <script>
    // ====== Model (state) ======
    const STORAGE_KEY = "todo_milos_v1";
    let todos = load();

    function save(){ localStorage.setItem(STORAGE_KEY, JSON.stringify(todos)); }
    function load(){
      try { return JSON.parse(localStorage.getItem(STORAGE_KEY)) ?? []; }
      catch { return []; }
    }

    // ====== View ======
    const listEl = document.getElementById('list');
    const inputEl = document.getElementById('newTask');
    const addBtn = document.getElementById('addBtn');
    const clearDoneBtn = document.getElementById('clearDone');
    const clearAllBtn = document.getElementById('clearAll');

    function render(){
      listEl.innerHTML = '';
      todos.forEach((t) => {
        const li = document.createElement('li');
        li.className = t.done ? 'done' : '';
        const left = document.createElement('div');
        left.className = 'task';

        const cb = document.createElement('input');
        cb.type = 'checkbox';
        cb.checked = t.done;
        cb.addEventListener('change', () => toggle(t.id));

        const label = document.createElement('label');
        label.textContent = t.text;

        left.appendChild(cb);
        left.appendChild(label);

        const del = document.createElement('button');
        del.textContent = 'Obriši';
        del.className = 'ghost';
        del.addEventListener('click', () => remove(t.id));

        li.appendChild(left);
        li.appendChild(del);
        listEl.appendChild(li);
      });
      addBtn.disabled = !inputEl.value.trim();
    }

    // ====== Controller (actions) ======
    function add(text){
      const trimmed = text.trim();
      if(!trimmed) return;
      todos.push({ id: Date.now(), text: trimmed, done: false });
      save(); render(); inputEl.value = ''; inputEl.focus(); addBtn.disabled = true;
    }
    function toggle(id){
      todos = todos.map(t => t.id === id ? { ...t, done: !t.done } : t);
      save(); render();
    }
    function remove(id){
      todos = todos.filter(t => t.id !== id);
      save(); render();
    }
    function clearDone(){
      todos = todos.filter(t => !t.done);
      save(); render();
    }
    function clearAll(){
      if(confirm('Da li sigurno želiš da obrišeš sve zadatke?')){
        todos = []; save(); render();
      }
    }

    // Events
    addBtn.addEventListener('click', () => add(inputEl.value));
    inputEl.addEventListener('keydown', (e) => {
      if(e.key === 'Enter') add(inputEl.value);
    });
    inputEl.addEventListener('input', () => { addBtn.disabled = !inputEl.value.trim(); });
    clearDoneBtn.addEventListener('click', clearDone);
    clearAllBtn.addEventListener('click', clearAll);

    // Init
    render();
  </script>
</body>
</html>
